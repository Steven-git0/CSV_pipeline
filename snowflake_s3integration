CREATE OR REPLACE STORAGE INTEGRATION S3_WCD_MIDTERM_LOADING_STAGE
  TYPE = EXTERNAL_STAGE
  STORAGE_PROVIDER = 'S3'
  ENABLED = TRUE
  STORAGE_AWS_ROLE_ARN = 'arn:aws:iam::235950863963:role/midterm-snowflakerole0'
  STORAGE_ALLOWED_LOCATIONS = ('s3://midterm-wcd0');

DESC STORAGE INTEGRATION S3_WCD_MIDTERM_LOADING_STAGE;

//RUN BELOW, DO NOT RUN CODE AT TOP 

GRANT CREATE STAGE ON SCHEMA raw TO ROLE accountadmin;
GRANT USAGE ON INTEGRATION S3_WCD_MIDTERM_LOADING_STAGE TO ROLE accountadmin;

CREATE OR REPLACE STAGE S3_WCD_MIDTERM_LOADING_STAGE
STORAGE_INTEGRATION = S3_WCD_MIDTERM_LOADING_STAGE
URL='s3://midterm-wcd0'
FILE_FORMAT = csv_comma_skip1_format;

DESC STAGE S3_WCD_MIDTERM_LOADING_STAGE;

list @S3_WCD_MIDTERM_LOADING_STAGE;
